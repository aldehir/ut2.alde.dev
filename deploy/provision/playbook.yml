---
- name: Provision UT2004 Servers
  hosts: ut2_server

  tasks:
    - name: Create instance
      ansible.builtin.include_role:
        name: ut2_server
      vars:
        ut2_server_image: "{{ inst.image | default(server_instance_default_image) }}"
        ut2_server_id: "{{ inst.id }}"
        ut2_server_game_port: "{{ inst.port }}"
        ut2_server_web_admin_port: "{{ inst.admin_port }}"
        ut2_server_info_name: "{{ inst.info.name }}"
        ut2_server_info_admin: "{{ inst.info.admin }}"
      loop: "{{ server_instances }}"
      loop_control:
        loop_var: inst
